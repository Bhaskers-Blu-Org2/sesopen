//-------------------------------------------------------------------------------------------------------
// Copyright (C) Microsoft Corporation and contributors. All rights reserved.
// See LICENSE.txt file in the project root for full license information.
//-------------------------------------------------------------------------------------------------------

namespace WebSec.Library.Engine
{
    /// <summary>
    /// Client is using this class to log vulnerabilities.
    /// </summary>
    public class Vulnerability
    {
        /// <summary>
        /// Gets or sets the title.
        /// </summary>
        /// <value>
        /// The title.
        /// </value>
        public string Title { get; set; }

        /// <summary>
        /// Gets or sets the level.
        /// </summary>
        /// <value>
        /// The level.
        /// </value>
        public int Level { get; set; }

        /// <summary>
        /// Gets or sets the tested parameter.
        /// </summary>
        /// <value>
        /// The tested parameter.
        /// </value>
        public string TestedParam { get; set; }

        /// <summary>
        /// Gets or sets the tested value.
        /// </summary>
        /// <value>
        /// The tested value.
        /// </value>
        public string TestedVal { get; set; }

        /// <summary>
        /// Gets or sets the match string.
        /// </summary>
        /// <value>
        /// The match string.
        /// </value>
        public string MatchString { get; set; }

        /// <summary>
        /// Gets or sets the evidence.
        /// </summary>
        /// <value>
        /// The evidence.
        /// </value>
        public string Evidence { get; set; }

        /// <summary>
        /// Gets or sets the test plugin.
        /// </summary>
        /// <value>
        /// The test plugin.
        /// </value>
        public string TestPlugin { get; set; }

        /// <summary>
        /// Gets or sets the http response.
        /// </summary>
        public HttpWebResponseHolder HttpResponse { get; set; }

        /// <summary>
        /// The to string.
        /// </summary>
        /// <returns>
        /// The <see cref="string"/>.
        /// </returns>
        public override string ToString()
        {
            if (!string.IsNullOrEmpty(this.Evidence))
            {
                // Simplifies debugging elsewhere if we can see what the vuln is.
                return this.Evidence;
            }

            return base.ToString();
        }
    }
}